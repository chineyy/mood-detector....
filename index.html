<!DOCTYPE html>
<html>
<head>
    <title>Teachable Machine Image Prediction</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest"></script>
</head>
<body>
    <h1>Teachable Machine Image Prediction</h1>
    <input type="file" id="file-upload" accept="image/*" />
    <button onclick="predict()">Predict</button>
    <div id="result"></div>

    <script>
        let model;
        const URL = "./"; // If model.json and metadata.json are in the same folder

        async function loadModel() {
            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";
            model = await tmImage.load(modelURL, metadataURL);
            console.log("Model Loaded!");
        }

        async function predict() {
            const fileInput = document.getElementById("file-upload");
            if (fileInput.files.length === 0) {
                alert("Please upload an image first.");
                return;
            }

            const image = document.createElement("img");
            image.src = URL.createObjectURL(fileInput.files[0]);
            await new Promise((resolve) => {
                image.onload = resolve;
            });

            const predictions = await model.predict(image);
            let resultText = "<h3>Predictions:</h3>";
            predictions.forEach(pred => {
                resultText += `${pred.className}: ${(pred.probability * 100).toFixed(2)}%<br>`;
            });
            document.getElementById("result").innerHTML = resultText;
        }

        loadModel();
    </script>
</body>
</html>
